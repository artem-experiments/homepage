{"name":"windows-baseline","title":"DevSec Windows Security Baseline","maintainer":"DevSec Hardening Framework Team","copyright":"DevSec Hardening Framework Team","copyright_email":"hello@dev-sec.io","license":"Apache 2 license","summary":"Baseline for best-practice Windows OS hardening","version":"1.1.1","supports":[{"platform-family":"windows"}],"controls":[{"title":"Verify the Windows folder permissions are properly set","desc":null,"descriptions":{},"impact":1.0,"refs":[],"tags":{},"code":"control 'windows-base-100' do\n  impact 1.0\n  title 'Verify the Windows folder permissions are properly set'\n  describe file('c:/windows') do\n    it { should be_directory }\n    # it { should_not be_readable }\n    # it { should_not be_writable.by('Administrator') }\n  end\nend\n","source_location":{"ref":"windows-baseline-master/controls/access_config.rb","line":5},"id":"windows-base-100"},{"title":"Safe DLL Search Mode is Enabled","desc":"cannot be managed via group policy\n@link: https://msdn.microsoft.com/en-us/library/ms682586(v=vs.85).aspx\n@link: https://technet.microsoft.com/en-us/library/dd277307.aspx","descriptions":{"default":"cannot be managed via group policy\n@link: https://msdn.microsoft.com/en-us/library/ms682586(v=vs.85).aspx\n@link: https://technet.microsoft.com/en-us/library/dd277307.aspx"},"impact":1.0,"refs":[],"tags":{},"code":"control 'windows-base-101' do\n  impact 1.0\n  title 'Safe DLL Search Mode is Enabled'\n  desc '\n    cannot be managed via group policy\n    @link: https://msdn.microsoft.com/en-us/library/ms682586(v=vs.85).aspx\n    @link: https://technet.microsoft.com/en-us/library/dd277307.aspx\n  '\n  describe registry_key('HKLM\\System\\CurrentControlSet\\Control\\Session Manager') do\n    it { should exist }\n    it { should_not have_property_value('SafeDllSearchMode', :type_dword, '0') }\n  end\nend\n","source_location":{"ref":"windows-baseline-master/controls/access_config.rb","line":17},"id":"windows-base-101"},{"title":"Anonymous Access to Windows Shares and Named Pipes is Disallowed","desc":null,"descriptions":{},"impact":1.0,"refs":[{"ref":"CIS Microsoft Windows Server 2012 R2 Benchmark"},{"ref":"CIS Microsoft Windows Server 2016 RTM (Release 1607) Benchmark"}],"tags":{"cis":["windows_2012r2:2.3.11.8","windows_2016:2.3.10.9"]},"code":"control 'windows-base-102' do\n  impact 1.0\n  title 'Anonymous Access to Windows Shares and Named Pipes is Disallowed'\n  tag cis: ['windows_2012r2:2.3.11.8', 'windows_2016:2.3.10.9']\n  ref 'CIS Microsoft Windows Server 2012 R2 Benchmark'\n  ref 'CIS Microsoft Windows Server 2016 RTM (Release 1607) Benchmark'\n  describe registry_key('HKLM\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters') do\n    it { should exist }\n    its('RestrictNullSessAccess') { should eq 1 }\n  end\nend\n","source_location":{"ref":"windows-baseline-master/controls/access_config.rb","line":33},"id":"windows-base-102"},{"title":"All Shares are Configured to Prevent Anonymous Access","desc":null,"descriptions":{},"impact":1.0,"refs":[],"tags":{},"code":"control 'windows-base-103' do\n  impact 1.0\n  title 'All Shares are Configured to Prevent Anonymous Access'\n  describe registry_key('HKLM\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters') do\n    it { should exist }\n    its('NullSessionShares') { should eq [''] }\n  end\nend\n","source_location":{"ref":"windows-baseline-master/controls/access_config.rb","line":45},"id":"windows-base-103"},{"title":"Force Encrypted Windows Network Passwords","desc":null,"descriptions":{},"impact":1.0,"refs":[],"tags":{},"code":"control 'windows-base-104' do\n  impact 1.0\n  title 'Force Encrypted Windows Network Passwords'\n  describe registry_key('HKLM\\System\\CurrentControlSet\\Services\\LanmanWorkstation\\Parameters') do\n    it { should exist }\n    its('EnablePlainTextPassword') { should eq 0 }\n  end\nend\n","source_location":{"ref":"windows-baseline-master/controls/access_config.rb","line":54},"id":"windows-base-104"},{"title":"SMB1 to Windows Shares is disabled","desc":"All Windows Shares are Configured to disable the SMB1 protocol","descriptions":{"default":"All Windows Shares are Configured to disable the SMB1 protocol"},"impact":1.0,"refs":[],"tags":{},"code":"control 'windows-base-105' do\n  title 'SMB1 to Windows Shares is disabled'\n  desc 'All Windows Shares are Configured to disable the SMB1 protocol'\n  impact 1.0\n  describe registry_key('HKLM\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters') do\n    it { should exist }\n    its('SMB1') { should eq 0 }\n  end\nend\n","source_location":{"ref":"windows-baseline-master/controls/access_config.rb","line":63},"id":"windows-base-105"},{"title":"Strong Windows NTLMv2 Authentication Enabled; Weak LM Disabled","desc":"@link: http://support.microsoft.com/en-us/kb/823659","descriptions":{"default":"@link: http://support.microsoft.com/en-us/kb/823659"},"impact":1.0,"refs":[],"tags":{},"code":"control 'windows-base-201' do\n  impact 1.0\n  title 'Strong Windows NTLMv2 Authentication Enabled; Weak LM Disabled'\n  desc '\n    @link: http://support.microsoft.com/en-us/kb/823659\n  '\n  describe registry_key('HKLM\\System\\CurrentControlSet\\Control\\Lsa') do\n    it { should exist }\n    its('LmCompatibilityLevel') { should eq 4 }\n  end\nend\n","source_location":{"ref":"windows-baseline-master/controls/access_config.rb","line":76},"id":"windows-base-201"},{"title":"Enable Strong Encryption for Windows Network Sessions on Clients","desc":null,"descriptions":{},"impact":1.0,"refs":[],"tags":{},"code":"control 'windows-base-202' do\n  impact 1.0\n  title 'Enable Strong Encryption for Windows Network Sessions on Clients'\n  describe registry_key('HKLM\\System\\CurrentControlSet\\Control\\Lsa\\MSV1_0') do\n    it { should exist }\n    its('NtlmMinClientSec') { should eq 537_395_200 }\n  end\nend\n","source_location":{"ref":"windows-baseline-master/controls/access_config.rb","line":88},"id":"windows-base-202"},{"title":"Enable Strong Encryption for Windows Network Sessions on Servers","desc":null,"descriptions":{},"impact":1.0,"refs":[],"tags":{},"code":"control 'windows-base-203' do\n  impact 1.0\n  title 'Enable Strong Encryption for Windows Network Sessions on Servers'\n  describe registry_key('HKLM\\System\\CurrentControlSet\\Control\\Lsa\\MSV1_0') do\n    it { should exist }\n    its('NtlmMinServerSec') { should eq 537_395_200 }\n  end\nend\n","source_location":{"ref":"windows-baseline-master/controls/access_config.rb","line":97},"id":"windows-base-203"},{"title":"1.2.1 Set Account lockout duration to 15 or more minutes","desc":"Set Account lockout duration to 15 or more minutes","descriptions":{"default":"Set Account lockout duration to 15 or more minutes"},"impact":0.7,"refs":[],"tags":{},"code":"control 'cis-account-lockout-duration-1.2.1' do\n  impact 0.7\n  title '1.2.1 Set Account lockout duration to 15 or more minutes'\n  desc 'Set Account lockout duration to 15 or more minutes'\n  describe security_policy do\n    its('LockoutDuration') { should be >= 15 }\n  end\nend\n","source_location":{"ref":"windows-baseline-master/controls/account_lockout.rb","line":5},"id":"cis-account-lockout-duration-1.2.1"},{"title":"1.2.2 Set Account lockout threshold to 10 or fewer invalid logon attempts but not 0","desc":"Set Account lockout threshold to 10 or fewer invalid logon attempts but not 0","descriptions":{"default":"Set Account lockout threshold to 10 or fewer invalid logon attempts but not 0"},"impact":0.7,"refs":[],"tags":{},"code":"control 'cis-account-lockout-threshold-1.2.2' do\n  impact 0.7\n  title '1.2.2 Set Account lockout threshold to 10 or fewer invalid logon attempts but not 0'\n  desc 'Set Account lockout threshold to 10 or fewer invalid logon attempts but not 0'\n  describe security_policy do\n    its('LockoutBadCount') { should be <= 10 }\n    its('LockoutBadCount') { should be > 0 }\n  end\nend\n","source_location":{"ref":"windows-baseline-master/controls/account_lockout.rb","line":14},"id":"cis-account-lockout-threshold-1.2.2"},{"title":"1.2.3 Set Reset account lockout counter after to 15 or more minutes","desc":"Set Reset account lockout counter after to 15 or more minutes","descriptions":{"default":"Set Reset account lockout counter after to 15 or more minutes"},"impact":0.7,"refs":[],"tags":{},"code":"control 'cis-reset-account-lockout-1.2.3' do\n  impact 0.7\n  title '1.2.3 Set Reset account lockout counter after to 15 or more minutes'\n  desc 'Set Reset account lockout counter after to 15 or more minutes'\n  describe security_policy do\n    its('ResetLockoutCount') { should be >= 15 }\n  end\nend\n","source_location":{"ref":"windows-baseline-master/controls/account_lockout.rb","line":24},"id":"cis-reset-account-lockout-1.2.3"},{"title":"Windows Remote Desktop Configured to Only Allow System Administrators Access","desc":null,"descriptions":{},"impact":1.0,"refs":[],"tags":{},"code":"control 'windows-account-100' do\n  impact 1.0\n  title 'Windows Remote Desktop Configured to Only Allow System Administrators Access'\n  describe security_policy do\n    # verifies that only the 'Administrators' group has remote access\n    its('SeRemoteInteractiveLogonRight') { should eq ['S-1-5-32-544'] }\n  end\nend\n","source_location":{"ref":"windows-baseline-master/controls/account_lockout.rb","line":33},"id":"windows-account-100"},{"title":"Windows Default Guest Account is Disabled","desc":null,"descriptions":{},"impact":1.0,"refs":[],"tags":{},"code":"control 'windows-account-101' do\n  impact 1.0\n  title 'Windows Default Guest Account is Disabled'\n  describe security_policy do\n    its('EnableGuestAccount') { should eq 0 }\n  end\nend\n","source_location":{"ref":"windows-baseline-master/controls/account_lockout.rb","line":42},"id":"windows-account-101"},{"title":"Windows Password Complexity is Enabled","desc":null,"descriptions":{},"impact":1.0,"refs":[{"url":"https://technet.microsoft.com/en-us/library/hh994562(v=ws.11).aspx","ref":"Password must meet complexity requirements"},{"ref":"CIS Microsoft Windows Server 2012 R2 Benchmark"},{"ref":"CIS Microsoft Windows Server 2016 RTM (Release 1607) Benchmark"}],"tags":{"cis":["windows_2012r2:1.1.5","windows_2016:1.1.5"]},"code":"control 'windows-account-102' do\n  impact 1.0\n  title 'Windows Password Complexity is Enabled'\n  tag cis: ['windows_2012r2:1.1.5', 'windows_2016:1.1.5']\n  ref 'Password must meet complexity requirements', url: 'https://technet.microsoft.com/en-us/library/hh994562(v=ws.11).aspx'\n  ref 'CIS Microsoft Windows Server 2012 R2 Benchmark'\n  ref 'CIS Microsoft Windows Server 2016 RTM (Release 1607) Benchmark'\n  describe security_policy do\n    its('PasswordComplexity') { should eq 1 }\n  end\nend\n","source_location":{"ref":"windows-baseline-master/controls/account_lockout.rb","line":50},"id":"windows-account-102"},{"title":"Minimum Windows Password Length Configured to be at Least 8 Characters","desc":"Minimum password length","descriptions":{"default":"Minimum password length"},"impact":1.0,"refs":[],"tags":{},"code":"control 'windows-account-103' do\n  impact 1.0\n  title 'Minimum Windows Password Length Configured to be at Least 8 Characters'\n  desc 'Minimum password length'\n  describe security_policy do\n    # TODO: check that the number is greater than 8\n    its('MinimumPasswordLength') { should_not eq 0 }\n  end\nend\n","source_location":{"ref":"windows-baseline-master/controls/account_lockout.rb","line":62},"id":"windows-account-103"},{"title":"Set Windows Account lockout threshold","desc":"Account lockout threshold, see https://technet.microsoft.com/en-us/library/hh994574.aspx","descriptions":{"default":"Account lockout threshold, see https://technet.microsoft.com/en-us/library/hh994574.aspx"},"impact":1.0,"refs":[],"tags":{},"code":"control 'windows-account-104' do\n  impact 1.0\n  title 'Set Windows Account lockout threshold'\n  desc 'Account lockout threshold, see https://technet.microsoft.com/en-us/library/hh994574.aspx'\n  describe security_policy do\n    # TODO: setting above 4 and below 10\n    its('LockoutBadCount') { should_not eq 0 }\n  end\nend\n","source_location":{"ref":"windows-baseline-master/controls/account_lockout.rb","line":72},"id":"windows-account-104"},{"title":"Windows Account Lockout Counter Configured to Wait at Least 30 Minutes Before Reset","desc":"Reset lockout counter after, see https://technet.microsoft.com/en-us/library/hh994568.aspx","descriptions":{"default":"Reset lockout counter after, see https://technet.microsoft.com/en-us/library/hh994568.aspx"},"impact":1.0,"refs":[],"tags":{},"code":"control 'windows-account-105' do\n  impact 1.0\n  title 'Windows Account Lockout Counter Configured to Wait at Least 30 Minutes Before Reset'\n  desc 'Reset lockout counter after, see https://technet.microsoft.com/en-us/library/hh994568.aspx'\n  describe security_policy do\n    # TODO: make time variable for ranges\n    its('ResetLockoutCount') { should_not eq 0 }\n  end\nend\n","source_location":{"ref":"windows-baseline-master/controls/account_lockout.rb","line":82},"id":"windows-account-105"},{"title":"Windows Account Lockout Duration Configured to at Least 30 Minutes","desc":"Account lockout duration, see https://technet.microsoft.com/en-us/library/hh994569.aspx","descriptions":{"default":"Account lockout duration, see https://technet.microsoft.com/en-us/library/hh994569.aspx"},"impact":1.0,"refs":[],"tags":{},"code":"control 'windows-account-106' do\n  impact 1.0\n  title 'Windows Account Lockout Duration Configured to at Least 30 Minutes'\n  desc 'Account lockout duration, see https://technet.microsoft.com/en-us/library/hh994569.aspx'\n  describe security_policy do\n    # TODO: make time variable for ranges\n    its('LockoutDuration') { should_not eq 0 }\n  end\nend\n","source_location":{"ref":"windows-baseline-master/controls/account_lockout.rb","line":92},"id":"windows-account-106"},{"title":"Configure System Event Log (Application)","desc":"Only appies for Windows 2008 and newer","descriptions":{"default":"Only appies for Windows 2008 and newer"},"impact":0.1,"refs":[],"tags":{},"code":"control 'windows-audit-100' do\n  impact 0.1\n  title 'Configure System Event Log (Application)'\n  desc 'Only appies for Windows 2008 and newer'\n  describe registry_key('HKLM\\Software\\Policies\\Microsoft\\Windows\\EventLog\\Application') do\n    it { should exist }\n    its('MaxSize') { should_not eq nil }\n  end\nend\n","source_location":{"ref":"windows-baseline-master/controls/audit_log_config.rb","line":5},"id":"windows-audit-100"},{"title":"Configure System Event Log (Security)","desc":"Only appies for Windows 2008 and newer","descriptions":{"default":"Only appies for Windows 2008 and newer"},"impact":0.1,"refs":[],"tags":{},"code":"control 'windows-audit-101' do\n  impact 0.1\n  title 'Configure System Event Log (Security)'\n  desc 'Only appies for Windows 2008 and newer'\n  describe registry_key('HKLM\\Software\\Policies\\Microsoft\\Windows\\EventLog\\Security') do\n    it { should exist }\n    its('MaxSize') { should_not eq nil }\n  end\nend\n","source_location":{"ref":"windows-baseline-master/controls/audit_log_config.rb","line":15},"id":"windows-audit-101"},{"title":"Configure System Event Log (Setup)","desc":"Only appies for Windows 2008 and newer","descriptions":{"default":"Only appies for Windows 2008 and newer"},"impact":0.1,"refs":[],"tags":{},"code":"control 'windows-audit-102' do\n  impact 0.1\n  title 'Configure System Event Log (Setup)'\n  desc 'Only appies for Windows 2008 and newer'\n  describe registry_key('HKLM\\Software\\Policies\\Microsoft\\Windows\\EventLog\\Setup') do\n    it { should exist }\n    its('MaxSize') { should_not eq nil }\n  end\nend\n","source_location":{"ref":"windows-baseline-master/controls/audit_log_config.rb","line":25},"id":"windows-audit-102"},{"title":"Configure System Event Log (System)","desc":"Only appies for Windows 2008 and newer","descriptions":{"default":"Only appies for Windows 2008 and newer"},"impact":0.1,"refs":[],"tags":{},"code":"control 'windows-audit-103' do\n  impact 0.1\n  title 'Configure System Event Log (System)'\n  desc 'Only appies for Windows 2008 and newer'\n  describe registry_key('HKLM\\Software\\Policies\\Microsoft\\Windows\\EventLog\\System') do\n    it { should exist }\n    its('MaxSize') { should_not eq nil }\n  end\nend\n","source_location":{"ref":"windows-baseline-master/controls/audit_log_config.rb","line":35},"id":"windows-audit-103"},{"title":"Kerberos Authentication Service Audit Log","desc":"policy_name: Audit Kerberos Authentication Service\npolicy_path: Computer Configuration\\Windows Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Logon","descriptions":{"default":"policy_name: Audit Kerberos Authentication Service\npolicy_path: Computer Configuration\\Windows Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Logon"},"impact":1.0,"refs":[],"tags":{},"code":"control 'windows-audit-201' do\n  impact 1.0\n  title 'Kerberos Authentication Service Audit Log'\n  desc '\n    policy_name: Audit Kerberos Authentication Service\n    policy_path: Computer Configuration\\Windows Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Logon\n  '\n  describe audit_policy do\n    its('Kerberos Authentication Service') { should_not eq 'No Auditing' }\n  end\nend\n","source_location":{"ref":"windows-baseline-master/controls/audit_log_config.rb","line":45},"id":"windows-audit-201"},{"title":"Kerberos Service Ticket Operations Audit Log","desc":"policy_name: Audit Kerberos Service Ticket Operations\npolicy_path: Computer Configuration\\Windows Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Logon","descriptions":{"default":"policy_name: Audit Kerberos Service Ticket Operations\npolicy_path: Computer Configuration\\Windows Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Logon"},"impact":1.0,"refs":[],"tags":{},"code":"control 'windows-audit-202' do\n  impact 1.0\n  title 'Kerberos Service Ticket Operations Audit Log'\n  desc '\n    policy_name: Audit Kerberos Service Ticket Operations\n    policy_path: Computer Configuration\\Windows Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Logon\n  '\n  describe audit_policy do\n    its('Kerberos Service Ticket Operations') { should_not eq 'No Auditing' }\n  end\nend\n","source_location":{"ref":"windows-baseline-master/controls/audit_log_config.rb","line":57},"id":"windows-audit-202"},{"title":"Account Logon Audit Log","desc":"policy_name: Audit Other Account Logon Events\npolicy_path: Computer Configuration\\Windows Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Logon","descriptions":{"default":"policy_name: Audit Other Account Logon Events\npolicy_path: Computer Configuration\\Windows Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Logon"},"impact":1.0,"refs":[],"tags":{},"code":"control 'windows-audit-203' do\n  impact 1.0\n  title 'Account Logon Audit Log'\n  desc '\n    policy_name: Audit Other Account Logon Events\n    policy_path: Computer Configuration\\Windows Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Logon\n  '\n  describe audit_policy do\n    its('Other Account Logon Events') { should_not eq 'No Auditing' }\n  end\nend\n","source_location":{"ref":"windows-baseline-master/controls/audit_log_config.rb","line":69},"id":"windows-audit-203"},{"title":"Audit Application Group Management","desc":"policy_path: Computer Configuration\\Windows Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Management","descriptions":{"default":"policy_path: Computer Configuration\\Windows Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Management"},"impact":1.0,"refs":[],"tags":{},"code":"control 'windows-audit-204' do\n  impact 1.0\n  title 'Audit Application Group Management'\n  desc '\n    policy_path: Computer Configuration\\Windows Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Management\n  '\n  describe audit_policy do\n    its('Application Group Management') { should_not eq 'No Auditing' }\n  end\nend\n","source_location":{"ref":"windows-baseline-master/controls/audit_log_config.rb","line":81},"id":"windows-audit-204"},{"title":"Audit Computer Account Management","desc":"policy_path: Computer Configuration\\Windows Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Management","descriptions":{"default":"policy_path: Computer Configuration\\Windows Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Management"},"impact":1.0,"refs":[{"ref":"CIS Microsoft Windows Server 2012 R2 Benchmark"},{"ref":"CIS Microsoft Windows Server 2016 RTM (Release 1607) Benchmark"}],"tags":{"cis":["windows_2012r2:17.2.2","windows_2016L:17.2.2"]},"code":"control 'windows-audit-205' do\n  impact 1.0\n  title 'Audit Computer Account Management'\n  desc '\n    policy_path: Computer Configuration\\Windows Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Management\n  '\n  tag cis: ['windows_2012r2:17.2.2', 'windows_2016L:17.2.2']\n  ref 'CIS Microsoft Windows Server 2012 R2 Benchmark'\n  ref 'CIS Microsoft Windows Server 2016 RTM (Release 1607) Benchmark'\n  describe audit_policy do\n    its('Computer Account Management') { should eq 'Success and Failure' }\n  end\nend\n","source_location":{"ref":"windows-baseline-master/controls/audit_log_config.rb","line":92},"id":"windows-audit-205"},{"title":"Audit Distributed Group Management","desc":"policy_path: Computer Configuration\\Windows Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Management","descriptions":{"default":"policy_path: Computer Configuration\\Windows Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Management"},"impact":1.0,"refs":[],"tags":{},"code":"control 'windows-audit-206' do\n  impact 1.0\n  title 'Audit Distributed Group Management'\n  desc '\n    policy_path: Computer Configuration\\Windows Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Management\n  '\n  describe audit_policy do\n    its('Distribution Group Management') { should_not eq 'No Auditing' }\n  end\nend\n","source_location":{"ref":"windows-baseline-master/controls/audit_log_config.rb","line":106},"id":"windows-audit-206"},{"title":"IE 64-bit tab","desc":null,"descriptions":{},"impact":1.0,"refs":[],"tags":{},"code":"control 'windows-ie-101' do\n  impact 1.0\n  title 'IE 64-bit tab'\n  describe registry_key('HKLM\\Software\\Policies\\Microsoft\\Internet Explorer\\Main') do\n    it { should exist }\n    its('Isolation64Bit') { should eq 1 }\n  end\nend\n","source_location":{"ref":"windows-baseline-master/controls/ie_config.rb","line":5},"id":"windows-ie-101"},{"title":"Run antimalware programs against ActiveX controls","desc":null,"descriptions":{},"impact":1.0,"refs":[],"tags":{},"code":"control 'windows-ie-102' do\n  impact 1.0\n  title 'Run antimalware programs against ActiveX controls'\n  describe registry_key('HKLM\\Software\\Policies\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Zones\\3') do\n    it { should exist }\n    its('270C') { should eq 0 }\n  end\nend\n","source_location":{"ref":"windows-baseline-master/controls/ie_config.rb","line":14},"id":"windows-ie-102"},{"title":"1.1.1 Set Enforce password history to 24 or more passwords","desc":"Set Enforce password history to 24 or more passwords","descriptions":{"default":"Set Enforce password history to 24 or more passwords"},"impact":0.7,"refs":[],"tags":{},"code":"control 'cis-enforce-password-history-1.1.1' do\n  impact 0.7\n  title '1.1.1 Set Enforce password history to 24 or more passwords'\n  desc 'Set Enforce password history to 24 or more passwords'\n  describe security_policy do\n    its('PasswordHistorySize') { should be >= 24 }\n  end\nend\n","source_location":{"ref":"windows-baseline-master/controls/password_policy.rb","line":5},"id":"cis-enforce-password-history-1.1.1"},{"title":"1.1.2 Set Maximum password age to 60 or fewer days, but not 0","desc":"Set Maximum password age to 60 or fewer days, but not 0","descriptions":{"default":"Set Maximum password age to 60 or fewer days, but not 0"},"impact":0.7,"refs":[],"tags":{},"code":"control 'cis-maximum-password-age-1.1.2' do\n  impact 0.7\n  title '1.1.2 Set Maximum password age to 60 or fewer days, but not 0'\n  desc 'Set Maximum password age to 60 or fewer days, but not 0'\n  describe security_policy do\n    its('MaximumPasswordAge') { should be <= 60 }\n    its('MaximumPasswordAge') { should be > 0 }\n  end\nend\n","source_location":{"ref":"windows-baseline-master/controls/password_policy.rb","line":14},"id":"cis-maximum-password-age-1.1.2"},{"title":"1.1.3 Set Minimum password age to 1 or more days","desc":"Set Minimum password age to 1 or more days","descriptions":{"default":"Set Minimum password age to 1 or more days"},"impact":0.7,"refs":[],"tags":{},"code":"control 'cis-minimum-password-age-1.1.3' do\n  impact 0.7\n  title '1.1.3 Set Minimum password age to 1 or more days'\n  desc 'Set Minimum password age to 1 or more days'\n  describe security_policy do\n    its('MinimumPasswordAge') { should be >= 1 }\n  end\nend\n","source_location":{"ref":"windows-baseline-master/controls/password_policy.rb","line":24},"id":"cis-minimum-password-age-1.1.3"},{"title":"1.1.4 Set Minimum password length to 14 or more characters","desc":"Set Minimum password length to 14 or more characters","descriptions":{"default":"Set Minimum password length to 14 or more characters"},"impact":0.7,"refs":[],"tags":{},"code":"control 'cis-minimum-password-length-1.1.4' do\n  impact 0.7\n  title '1.1.4 Set Minimum password length to 14 or more characters'\n  desc 'Set Minimum password length to 14 or more characters'\n  describe security_policy do\n    its('MinimumPasswordLength') { should be >= 14 }\n  end\nend\n","source_location":{"ref":"windows-baseline-master/controls/password_policy.rb","line":33},"id":"cis-minimum-password-length-1.1.4"},{"title":"1.1.6 Set Store passwords using reversible encryption to Disabled","desc":"Set Store passwords using reversible encryption to Disabled","descriptions":{"default":"Set Store passwords using reversible encryption to Disabled"},"impact":0.7,"refs":[],"tags":{},"code":"control 'cis-password-complexity-1.1.6' do\n  impact 0.7\n  title '1.1.6 Set Store passwords using reversible encryption to Disabled'\n  desc 'Set Store passwords using reversible encryption to Disabled'\n  describe security_policy do\n    its('ClearTextPassword') { should eq 0 }\n  end\nend\n","source_location":{"ref":"windows-baseline-master/controls/password_policy.rb","line":42},"id":"cis-password-complexity-1.1.6"},{"title":"PowerShell Script Block Logging","desc":"Enabling PowerShell script block logging will record detailed information from the processing of PowerShell commands and scripts","descriptions":{"default":"Enabling PowerShell script block logging will record detailed information from the processing of PowerShell commands and scripts"},"impact":1.0,"refs":[{"url":"https://benchmarks.cisecurity.org/tools2/windows/CIS_Microsoft_Windows_Server_2012_R2_Benchmark_v2.2.1.pdf","ref":"CIS Microsoft Windows Server 2012 R2 Benchmark"}],"tags":{"cis":"18.9.84.1"},"code":"control 'powershell-script-blocklogging' do\n  impact 1.0\n  title 'PowerShell Script Block Logging'\n  desc 'Enabling PowerShell script block logging will record detailed information from the processing of PowerShell commands and scripts'\n  tag cis: '18.9.84.1'\n  ref 'CIS Microsoft Windows Server 2012 R2 Benchmark', url: 'https://benchmarks.cisecurity.org/tools2/windows/CIS_Microsoft_Windows_Server_2012_R2_Benchmark_v2.2.1.pdf'\n  describe registry_key('HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging') do\n    it { should exist }\n    its('EnableScriptBlockLogging') { should eq 0 }\n  end\nend\n","source_location":{"ref":"windows-baseline-master/controls/powershell.rb","line":5},"id":"powershell-script-blocklogging"},{"title":"PowerShell Transcription","desc":"Transcription creates a unique record of every PowerShell session, including all input and output, exactly as it appears in the session.","descriptions":{"default":"Transcription creates a unique record of every PowerShell session, including all input and output, exactly as it appears in the session."},"impact":1.0,"refs":[{"url":"https://benchmarks.cisecurity.org/tools2/windows/CIS_Microsoft_Windows_Server_2012_R2_Benchmark_v2.2.1.pdf","ref":"CIS Microsoft Windows Server 2012 R2 Benchmark"}],"tags":{"cis":"18.9.84.2"},"code":"control 'powershell-transcription' do\n  impact 1.0\n  title 'PowerShell Transcription'\n  desc 'Transcription creates a unique record of every PowerShell session, including all input and output, exactly as it appears in the session.'\n  tag cis: '18.9.84.2'\n  ref 'CIS Microsoft Windows Server 2012 R2 Benchmark', url: 'https://benchmarks.cisecurity.org/tools2/windows/CIS_Microsoft_Windows_Server_2012_R2_Benchmark_v2.2.1.pdf'\n  describe registry_key('HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\Transcription') do\n    it { should exist }\n    its('EnableTranscripting') { should eq 0 }\n  end\nend\n","source_location":{"ref":"windows-baseline-master/controls/powershell.rb","line":17},"id":"powershell-transcription"},{"title":"Microsoft Online Accounts","desc":"Disabling Microsoft account logon sign-in option, eg. logging in without having to use local credentials and using microsoft online accounts","descriptions":{"default":"Disabling Microsoft account logon sign-in option, eg. logging in without having to use local credentials and using microsoft online accounts"},"impact":1.0,"refs":[{"url":"https://technet.microsoft.com/en-us/library/jj966262(v=ws.11).aspx","ref":"Block Microsoft Accounts"}],"tags":{},"code":"control 'microsoft-online-accounts' do\n  impact 1.0\n  title 'Microsoft Online Accounts'\n  desc 'Disabling Microsoft account logon sign-in option, eg. logging in without having to use local credentials and using microsoft online accounts'\n  ref 'Block Microsoft Accounts', url: 'https://technet.microsoft.com/en-us/library/jj966262(v=ws.11).aspx'\n  describe registry_key('HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\default\\Settings\\AllowYourAccount') do\n    it { should exist }\n    its('value') { should eq 0 }\n  end\nend\n","source_location":{"ref":"windows-baseline-master/controls/privacy.rb","line":5},"id":"microsoft-online-accounts"},{"title":"Disable Windows Store","desc":"Ensure Turn off Automatic Download and Install ofupdates is set to Disabled","descriptions":{"default":"Ensure Turn off Automatic Download and Install ofupdates is set to Disabled"},"impact":1.0,"refs":[{"url":"https://benchmarks.cisecurity.org/tools2/windows/CIS_Microsoft_Windows_Server_2012_R2_Benchmark_v2.2.1.pdf","ref":"CIS Microsoft Windows Server 2012 R2 Benchmark"}],"tags":{"cis":"18.9.61.1"},"code":"control 'disable-windows-store' do\n  impact 1.0\n  title 'Disable Windows Store'\n  desc 'Ensure Turn off Automatic Download and Install ofupdates is set to Disabled'\n  tag cis: '18.9.61.1'\n  ref 'CIS Microsoft Windows Server 2012 R2 Benchmark', url: 'https://benchmarks.cisecurity.org/tools2/windows/CIS_Microsoft_Windows_Server_2012_R2_Benchmark_v2.2.1.pdf'\n  describe registry_key('HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsStore') do\n    it { should exist }\n    its('AutoDownload') { should eq 4 }\n    its('DisableOSUpgrade') { should eq 1 }\n  end\nend\n","source_location":{"ref":"windows-baseline-master/controls/privacy.rb","line":16},"id":"disable-windows-store"},{"title":"Disable indexing encrypted files","desc":"Ensure Allow indexing of encrypted files is set to Disabled","descriptions":{"default":"Ensure Allow indexing of encrypted files is set to Disabled"},"impact":1.0,"refs":[{"url":"https://benchmarks.cisecurity.org/tools2/windows/CIS_Microsoft_Windows_Server_2012_R2_Benchmark_v2.2.1.pdf","ref":"CIS Microsoft Windows Server 2012 R2 Benchmark"}],"tags":{"cis":"18.9.54.2"},"code":"control 'disable-index-encrypted-files' do\n  impact 1.0\n  title 'Disable indexing encrypted files'\n  desc 'Ensure Allow indexing of encrypted files is set to Disabled'\n  tag cis: '18.9.54.2'\n  ref 'CIS Microsoft Windows Server 2012 R2 Benchmark', url: 'https://benchmarks.cisecurity.org/tools2/windows/CIS_Microsoft_Windows_Server_2012_R2_Benchmark_v2.2.1.pdf'\n  describe registry_key('HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search') do\n    it { should exist }\n    its('AllowIndexingEncryptedStoresOrItems') { should eq 0 }\n  end\nend\n","source_location":{"ref":"windows-baseline-master/controls/privacy.rb","line":29},"id":"disable-index-encrypted-files"},{"title":"Windows Remote Desktop Configured to Always Prompt for Password","desc":null,"descriptions":{},"impact":1.0,"refs":[],"tags":{},"code":"control 'windows-rdp-100' do\n  impact 1.0\n  title 'Windows Remote Desktop Configured to Always Prompt for Password'\n  describe registry_key('HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services') do\n    it { should exist }\n    its('fPromptForPassword') { should eq 1 }\n  end\nend\n","source_location":{"ref":"windows-baseline-master/controls/rdp_config.rb","line":5},"id":"windows-rdp-100"},{"title":"Strong Encryption for Windows Remote Desktop Required","desc":null,"descriptions":{},"impact":1.0,"refs":[],"tags":{},"code":"control 'windows-rdp-101' do\n  impact 1.0\n  title 'Strong Encryption for Windows Remote Desktop Required'\n  describe registry_key('HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services') do\n    it { should exist }\n    its('MinEncryptionLevel') { should eq 3 }\n  end\nend\n","source_location":{"ref":"windows-baseline-master/controls/rdp_config.rb","line":14},"id":"windows-rdp-101"},{"title":"2.2.1 Set Access Credential Manager as a trusted caller to No One","desc":"Set Access Credential Manager as a trusted caller to No One","descriptions":{"default":"Set Access Credential Manager as a trusted caller to No One"},"impact":0.7,"refs":[],"tags":{},"code":"control 'cis-access-cred-manager-2.2.1' do\n  impact 0.7\n  title '2.2.1 Set Access Credential Manager as a trusted caller to No One'\n  desc 'Set Access Credential Manager as a trusted caller to No One'\n  describe security_policy do\n    its('SeTrustedCredManAccessPrivilege') { should eq ['S-1-0-0'] }\n  end\nend\n","source_location":{"ref":"windows-baseline-master/controls/user_rights.rb","line":5},"id":"cis-access-cred-manager-2.2.1"},{"title":"2.2.2 Set Access this computer from the network","desc":"Set Access this computer from the network","descriptions":{"default":"Set Access this computer from the network"},"impact":0.7,"refs":[],"tags":{},"code":"control 'cis-network-access-2.2.2' do\n  impact 0.7\n  title '2.2.2 Set Access this computer from the network'\n  desc 'Set Access this computer from the network'\n  describe security_policy do\n    its('SeNetworkLogonRight') { should eq ['S-1-0-0'] }\n  end\nend\n","source_location":{"ref":"windows-baseline-master/controls/user_rights.rb","line":14},"id":"cis-network-access-2.2.2"},{"title":"2.2.3 Set Act as part of the operating system to No One","desc":"Set Act as part of the operating system to No One","descriptions":{"default":"Set Act as part of the operating system to No One"},"impact":0.7,"refs":[],"tags":{},"code":"control 'cis-act-as-os-2.2.3' do\n  impact 0.7\n  title '2.2.3 Set Act as part of the operating system to No One'\n  desc 'Set Act as part of the operating system to No One'\n  describe security_policy do\n    its('SeTcbPrivilege') { should eq ['S-1-0-0'] }\n  end\nend\n","source_location":{"ref":"windows-baseline-master/controls/user_rights.rb","line":23},"id":"cis-act-as-os-2.2.3"},{"title":"2.2.4 Set Add workstations to domain to Administrators","desc":"Set Add workstations to domain to Administrators","descriptions":{"default":"Set Add workstations to domain to Administrators"},"impact":0.7,"refs":[],"tags":{},"code":"control 'cis-add-workstations-2.2.4' do\n  impact 0.7\n  title '2.2.4 Set Add workstations to domain to Administrators'\n  desc 'Set Add workstations to domain to Administrators'\n  describe security_policy do\n    its('SeMachineAccountPrivilege') { should eq ['S-1-5-32-544'] }\n  end\nend\n","source_location":{"ref":"windows-baseline-master/controls/user_rights.rb","line":32},"id":"cis-add-workstations-2.2.4"},{"title":"2.2.5 Set Adust memory quotas for a process to Administrators, LOCAL SERVICE, NETWORK SERVICE","desc":"Set Adust memory quotas for a process to Administrators, LOCAL SERVICE, NETWORK SERVICE","descriptions":{"default":"Set Adust memory quotas for a process to Administrators, LOCAL SERVICE, NETWORK SERVICE"},"impact":0.7,"refs":[],"tags":{},"code":"control 'cis-adjust-memory-quotas-2.2.5' do\n  impact 0.7\n  title '2.2.5 Set Adust memory quotas for a process to Administrators, LOCAL SERVICE, NETWORK SERVICE'\n  desc 'Set Adust memory quotas for a process to Administrators, LOCAL SERVICE, NETWORK SERVICE'\n  describe security_policy do\n    its('SeIncreaseQuotaPrivilege') { should include 'S-1-5-19' }\n    its('SeIncreaseQuotaPrivilege') { should include 'S-1-5-20' }\n    its('SeIncreaseQuotaPrivilege') { should include 'S-1-5-32-544' }\n  end\nend\n","source_location":{"ref":"windows-baseline-master/controls/user_rights.rb","line":41},"id":"cis-adjust-memory-quotas-2.2.5"}],"groups":[{"title":"Windows Access Configuration","controls":["windows-base-100","windows-base-101","windows-base-102","windows-base-103","windows-base-104","windows-base-105","windows-base-201","windows-base-202","windows-base-203"],"id":"controls/access_config.rb"},{"title":"Account Lockout Policy","controls":["cis-account-lockout-duration-1.2.1","cis-account-lockout-threshold-1.2.2","cis-reset-account-lockout-1.2.3","windows-account-100","windows-account-101","windows-account-102","windows-account-103","windows-account-104","windows-account-105","windows-account-106"],"id":"controls/account_lockout.rb"},{"title":"Windows Audit & Logging Configuration","controls":["windows-audit-100","windows-audit-101","windows-audit-102","windows-audit-103","windows-audit-201","windows-audit-202","windows-audit-203","windows-audit-204","windows-audit-205","windows-audit-206"],"id":"controls/audit_log_config.rb"},{"title":"Windows IE Configuration","controls":["windows-ie-101","windows-ie-102"],"id":"controls/ie_config.rb"},{"title":"Password Policy","controls":["cis-enforce-password-history-1.1.1","cis-maximum-password-age-1.1.2","cis-minimum-password-age-1.1.3","cis-minimum-password-length-1.1.4","cis-password-complexity-1.1.6"],"id":"controls/password_policy.rb"},{"title":"Windows PowerShell","controls":["powershell-script-blocklogging","powershell-transcription"],"id":"controls/powershell.rb"},{"title":"Windows Privacy","controls":["microsoft-online-accounts","disable-windows-store","disable-index-encrypted-files"],"id":"controls/privacy.rb"},{"title":"Windows RDP Configuration","controls":["windows-rdp-100","windows-rdp-101"],"id":"controls/rdp_config.rb"},{"title":"User Rights Assignment","controls":["cis-access-cred-manager-2.2.1","cis-network-access-2.2.2","cis-act-as-os-2.2.3","cis-add-workstations-2.2.4","cis-adjust-memory-quotas-2.2.5"],"id":"controls/user_rights.rb"}],"attributes":[],"sha256":"45c4caa3cbd3b0d3535412aca10a142a899ed9b4aefc45bc7a2ee0bc4ab2efd3","generator":{"name":"inspec","version":"2.3.10"}}
